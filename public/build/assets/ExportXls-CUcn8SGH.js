import{d as g,r as w,g as V,C as P,c as _,o as h,a as o,u as t,m as C,w as u,b as s,t as v,e as d,f as m,P as y,v as p,F as G}from"./app-B-cmbjvL.js";import{_ as D}from"./AppLayout.vue_vue_type_script_setup_true_lang-PEPtDQ3f.js";import{S as x}from"./SettingsPanel-CCEzC1Lv.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-CyUlp5Kt.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CzG4im2e.js";import"./RovingFocusGroup-2U8FBijs.js";import"./useForwardExpose-CZ06Ebnk.js";const U={class:"max-w-7xl mx-auto px-4"},j={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},k={class:"p-4 bg-white border-b border-gray-200 space-y-4"},L={class:"py-2 text-center"},F={class:"flex flex-col space-y-1 text-center sm:space-y-0 sm:flex-row sm:justify-between sm:space-x-1"},X=["href"],B={class:"text-center"},E={class:"flex flex-col space-y-1 text-center sm:space-y-0 sm:flex-row sm:justify-between sm:space-x-1"},N=["href"],A={class:"text-center"},I=["action"],T=["value"],$={class:"flex flex-col space-y-1 text-center sm:space-y-0 sm:flex-row sm:justify-between sm:space-x-1"},O=["disabled"],q={class:"mt-4 flex flex-col space-y-1 text-center sm:space-y-0 sm:flex-row sm:justify-between sm:space-x-1"},z=g({__name:"ExportXls",props:{activeGradePeriod:{},token:{}},setup(H){const r=w(""),i=w(""),b=new Date(Date.now()).toLocaleString().split(",")[0],c=V(function(){let l="exportApouxls";return(r.value||i.value)&&(l+="?"),r.value&&(l+="apoDate="+r.value),r.value&&i.value&&(l+="&"),i.value&&(l+="eosDate="+i.value),l}),n=P({xls:null,rowLabels:3,amColumn:2,lessonColumn:5});return(l,e)=>(h(),_(G,null,[o(t(C),{title:"Εξαγωγή xls"}),o(D,null,{default:u(()=>[e[16]||(e[16]=s("div",{class:"px-4 pt-4 w-full max-w-7xl mx-auto"},[s("div",{class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},[s("div",{class:"p-6 bg-white border-b border-gray-200 flex justify-between"},[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Εξαγωγή xls ")])])],-1)),s("div",null,[s("div",U,[s("div",j,[s("div",k,[o(x,{title:"Εξαγωγή απουσιών για τις ημερομηνίες"},{default:u(()=>[s("div",L," κενές ημ/νιες = σήμερα: "+v(t(b)),1),s("div",F,[s("div",null,[e[6]||(e[6]=d(" από ")),o(f,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:"date",class:"py-1"},null,8,["modelValue"])]),s("div",null,[e[7]||(e[7]=d(" έως ")),o(f,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),type:"date",class:"py-1"},null,8,["modelValue"])]),s("a",{href:c.value,as:"button",type:"button",class:"gth"}," Εξαγωγή_xls ",8,X)])]),_:1}),o(x,{title:"Εξαγωγή αρχείου 187.xls όλων των μαθητών όλων των τάξεων για καταχώριση στο myschool"},{default:u(()=>[m(s("div",B,[e[9]||(e[9]=d(" Επιλέξτε βαθμολογική περίοδο στις ")),o(t(y),{href:l.route("settings"),class:"underline"},{default:u(()=>e[8]||(e[8]=[d("ρυθμίσεις")])),_:1},8,["href"])],512),[[p,!l.activeGradePeriod]]),m(s("div",E,[e[10]||(e[10]=s("div",null,"Βαθμολογική περίοδος:",-1)),s("div",null,v(l.activeGradePeriod),1),s("a",{href:l.route("gradesXls"),class:"gth"}," Εξαγωγή_xls ",8,N)],512),[[p,l.activeGradePeriod]])]),_:1}),o(x,{title:"Ενημέρωση των εξηχθέντων αρχείων 187.xls για κάθε τάξη από το myschool"},{default:u(()=>[m(s("div",A,[e[12]||(e[12]=d(" Επιλέξτε βαθμολογική περίοδο στις ")),o(t(y),{href:l.route("settings"),class:"underline"},{default:u(()=>e[11]||(e[11]=[d("ρυθμίσεις")])),_:1},8,["href"])],512),[[p,!l.activeGradePeriod]]),s("form",{name:"frm",id:"frm",role:"form",method:"POST",action:l.route("populateGradesXls"),enctype:"multipart/form-data"},[s("input",{type:"hidden",name:"_token",value:l.token},null,8,T),m(s("div",$,[s("div",null,v(l.activeGradePeriod),1),s("input",{type:"file",class:"gthFile",name:"xls",onInput:e[2]||(e[2]=a=>t(n).xls=a.target.files[0])},null,32),s("button",{type:"submit",class:"gth",disabled:!t(n).xls||t(n).processing||!l.activeGradePeriod}," Ενημέρωση_xls ",8,O)],512),[[p,l.activeGradePeriod]]),m(s("div",q,[s("div",null,[e[13]||(e[13]=d(" Γραμμή επικεφαλίδων ")),o(f,{name:"rowLabels",modelValue:t(n).rowLabels,"onUpdate:modelValue":e[3]||(e[3]=a=>t(n).rowLabels=a),class:"py-1 w-10 border text-center"},null,8,["modelValue"])]),s("div",null,[e[14]||(e[14]=d(" Κολώνα Αρ. Μητρώου ")),o(f,{name:"amColumn",modelValue:t(n).amColumn,"onUpdate:modelValue":e[4]||(e[4]=a=>t(n).amColumn=a),class:"py-1 w-10 border text-center"},null,8,["modelValue"])]),s("div",null,[e[15]||(e[15]=d(" Κολώνα 1ου μαθήματος ")),o(f,{name:"lessonColumn",modelValue:t(n).lessonColumn,"onUpdate:modelValue":e[5]||(e[5]=a=>t(n).lessonColumn=a),class:"py-1 w-10 border text-center"},null,8,["modelValue"])])],512),[[p,l.activeGradePeriod]])],8,I)]),_:1})])])])])]),_:1})],64))}}),ee=S(z,[["__scopeId","data-v-1fe4bff4"]]);export{ee as default};
