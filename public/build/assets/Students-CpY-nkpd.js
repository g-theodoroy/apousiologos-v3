import{d as J,r as $,j as E,C as j,k as K,W as F,c as m,o as u,a as b,h as q,u as d,m as Q,w as z,b as t,e as U,t as i,f as V,F as f,l as w,x as X,q as g,v as L,y as Y,n as I}from"./app-B-cmbjvL.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-PEPtDQ3f.js";import{P as te}from"./Pagination-B66SzgXw.js";import{_ as y}from"./Input.vue_vue_type_script_setup_true_lang-CyUlp5Kt.js";import{_ as oe}from"./GthSuccess.vue_vue_type_script_setup_true_lang-kvLgG3Gb.js";import{_ as le}from"./Checkbox.vue_vue_type_script_setup_true_lang-CcG7xGwb.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CzG4im2e.js";import"./RovingFocusGroup-2U8FBijs.js";import"./useForwardExpose-CZ06Ebnk.js";const re={class:"px-4 pt-4 w-full max-w-7xl mx-auto"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ne={class:"p-6 bg-white border-b border-gray-200 flex justify-between"},ie={class:"max-w-7xl mx-auto px-4"},de={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},me={class:"p-4 bg-white border-b border-gray-200"},ue={class:"flex justify-between space-x-2"},pe=["value"],ce=["value"],be={class:"w-full flex-row flex-no-wrap bg-white rounded-lg overflow-hidden sm:shadow-lg my-2 inline-table"},fe={class:"flex-1 sm:flex-none space-y-2"},ge={class:"text-white bg-gray-400 flex flex-col flex-no wrap sm:table-row rounded-t-lg"},he=["title","onClick"],ve={class:"flex flex-col flex-no wrap sm:table-row hover:bg-gray-100 text-sm"},we={class:"border-grey-light border hover:bg-gray-100 p-2 text-left sm:text-center"},ye={class:"border-grey-light border p-2 text-left sm:text-center"},xe={class:"border-grey-light border p-2 text-left sm:text-center"},_e={class:"border-grey-light border p-2 text-left sm:text-center"},ke={class:"border-grey-light border p-2"},Se={class:"border-grey-light border p-2"},Ve={class:"border-grey-light border p-2 sm:hidden md:table-cell"},Ce={class:"border-grey-light border p-2 sm:hidden lg:table-cell"},Ae={class:"border-grey-light border p-2 sm:hidden xl:table-cell"},$e={class:"border-grey-light border p-2 truncate text-left sm:text-center space-x-2"},Le=["onClick","disabled","title"],Ue=["onClick","title"],Ee=["onClick","title"],Fe=["onClick","title"],De={class:"flex flex-col flex-no wrap sm:table-row bg-blue-100"},Ne=["colspan"],Be={class:"w-11/12 sm:w-10/12 bg-white rounded-lg overflow-hidden sm:shadow-lg my-2 inline-table"},je={class:"flex-1 sm:flex-none"},qe={class:"text-white bg-gray-400 table-row rounded-t-lg"},ze={class:"table-row hover:bg-gray-100 text-sm"},Ie={rowspan:"2",class:"border-grey-light border p-1 text-center sm:hidden"},Me={class:"border-grey-light border px-2 text-center hidden sm:table-cell"},Oe={class:"border-grey-light border p-1 sm:px-2 text-center"},Te={class:"border-grey-light border p-1 sm:px-2 text-center"},Re={class:"border-grey-light border p-1 sm:px-2 text-center font-bold"},Ze={class:"border-grey-light border p-1 sm:px-2 text-center font-bold hidden sm:table-cell"},He=["title"],Pe={class:"border-grey-light border p-1 sm:px-2 text-center space-x-2"},We=["onClick","title"],Ge=["onClick","title"],Je={class:"sm:hidden hover:bg-gray-100"},Ke={colspan:"5",class:"border text-xs"},Qe={class:"w-full"},Xe={key:0,class:"fixed z-10 inset-0 overflow-y-auto ease-out duration-400"},Ye={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},et={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},tt={class:"font-semibold text-xl p-2 bg-gray-100 rounded-t-md mx-4 mt-4"},ot={class:"grid grid-cols-3 sm:grid-cols-6 gap-4 bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},lt={class:"bg-gray-100 px-4 py-3 sm:px-6 text-right space-x-2"},st=["disabled"],rt={key:1,class:"fixed z-10 inset-0 overflow-y-auto ease-out duration-400"},at={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},nt={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},it={class:"font-semibold text-xl p-2 bg-gray-100 rounded-t-md mx-4 mt-4"},dt={class:"font-semibold text-xl mx-4 mt-2 text-center"},mt={class:"flex bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 justify-evenly"},ut={class:"flex"},pt={class:"flex bg-gray-100 space-x-1 pb-1 mx-2 rounded-lg"},ct=["title"],bt=["onClick"],ft={class:"bg-gray-100 px-4 py-3 sm:px-6 text-right space-x-2"},gt=["disabled"],ht=J({__name:"Students",props:{students:{},arrNames:{},tableLabels:{},filters:{},fields:{},queryStr:{},iniShowApouForStu:{},tableApouLabels:{},apousiesForStudent:{},tmimataRows:{},totalHours:{},formStudents:{},formApousies:{}},setup(M){const h=M,k=$(h.iniShowApouForStu),S=E({open:!1}),C=$(!1),A=$(!1),x=$(!1),D=$(""),s=j(h.formStudents),r=j(h.formApousies),c=E({msg:""}),p=E({page:h.filters.page,rows:h.filters.rows,search:h.filters.search,field:h.filters.field,direction:h.filters.direction});K(p,(l,o)=>{let e=p;Object.keys(e).forEach(a=>{e[a]==""&&delete e[a]}),F.get(route("students"),e,{replace:!0,preserveState:!0,preserveScroll:!0})});function O(l){l!=""&&(p.field!==l?p.direction="asc":p.direction=p.direction=="asc"?"desc":"asc",p.field=l)}function N(l){s.reset(),c.msg="",l?(A.value=!0,s.id=l.id,s.oldId=l.id,s.eponimo=l.eponimo,s.onoma=l.onoma,s.patronimo=l.patronimo,s.email=l.email,l.tmimataStr&&l.tmimataStr.split(", ").forEach((e,a)=>{s.tmima[a]=e})):A.value=!1,S.open=!0;const o=e=>{e.keyCode===27&&(S.open=!1,document.removeEventListener("keydown",o))};document.addEventListener("keydown",o)}function T(l){F.delete(`studentDelete/${l.id}`,{onBefore:()=>confirm(l.eponimo+" "+l.onoma+`

Θέλετε να διαγραφεί?`),preserveScroll:!0})}function B(l,o){if(r.reset(),c.msg="",D.value=l.eponimo+" "+l.onoma,r.student_id=l.id,o){x.value=!0,r.date=o.date;for(var e in o.arrApou.apou)r.apou[e]=o.arrApou.apou[e],r.apov[e]=o.arrApou.apov[e],r.teach[e]=o.arrApou.teach[e]}else x.value=!1,r.date=new Date().toISOString().split("T")[0];C.value=!0;const a=n=>{n.keyCode===27&&(C.value=!1,document.removeEventListener("keydown",a))};document.addEventListener("keydown",a)}function R(l,o){F.delete(`apousiesDelete/${o.id}`,{onBefore:()=>confirm(l.eponimo+" "+l.onoma+`
Ημνια: `+o.dateShow+`
Απουσίες: `+o.sum+`

Θέλετε να διαγραφoύν οι απουσίες?`),preserveScroll:!0}),h.apousiesForStudent[l.id].length<2&&(k[l.id]=!1)}function Z(){if(!s.id){c.msg="Συμπληρώστε τον Αρ.Μητρώου";return}if(isNaN(s.id)){c.msg=`Ο Αρ. Μητρώου "${s.id}" δεν είναι αριθμός`;return}if(!s.eponimo){c.msg="Συμπληρώστε το Επώνυμο";return}if(!s.onoma){c.msg="Συμπληρώστε το Όνομα";return}let l=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(s.email&&!s.email.match(l)){c.msg=`Το email "${s.email}" δεν είναι έγκυρο`;return}if(s.id==s.oldId)s.post(route("students.store"),{preserveScroll:!0}),s.reset(),S.open=!1;else{let o=s.id;Y.get("studentUnique/"+o).then(function(e){if(e.data>0){c.msg=`Ο Αρ. Μητρώου "${o}" χρησιμοποιείται`;return}else s.post(route("students.store"),{preserveScroll:!0}),s.reset(),S.open=!1})}}function H(){if(!r.date){c.msg="Επιλέξτε την ημερομηνία";return}let l=!1;for(var o in r.apou)isNaN(o)||r.apou[o]&&(l=!0);if(!l){c.msg="Καταχωρίστε τούλαχιστον μία απουσία";return}if(!x){let e=null;if(h.apousiesForStudent[r.student_id].forEach(a=>{if(a.date==r.date){e=a.dateShow;return}}),e&&!confirm("Υπάρχουν καταχωρισμένες απουσίες τις "+e+`.
Αν συνεχίσετε θα αντικατασταθούν από τις παρούσες.
Θέλετε ωστόσο να συνεχίσετε;`))return}r.post(route("apousiesStore"),{preserveScroll:!0}),r.reset(),C.value=!1}function P(){return new Date().toLocaleTimeString()}function W(l){r.apov[l]==!1?(r.apou[l]=!0,r.apov[l]=!0,r.teach[l]=I().props.auth.user.id):r.apov[l]=!1}function G(l){r.apou[l]==!0?(r.apov[l]=!1,r.teach[l]=""):r.teach[l]=I().props.auth.user.id}return(l,o)=>(u(),m(f,null,[b(d(Q),{title:"Μαθητές"}),b(ee,null,{default:z(()=>[b(oe,null,{default:z(()=>[U(i(P()),1)]),_:1}),t("div",re,[t("div",ae,[t("div",ne,[o[11]||(o[11]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Μαθητές ",-1)),t("button",{onClick:o[0]||(o[0]=e=>N()),class:"gthButton mr-10 md:mr-0"}," Εισαγωγή μαθητή ")])])]),t("div",null,[t("div",ie,[t("div",de,[t("div",me,[t("div",ue,[V(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>p.rows=e),value:l.filters.rows,class:"border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-100 rounded-md shadow-sm p-1 sm:px-2 w-20"},[(u(),m(f,null,w([10,20,50,100],e=>t("option",{key:e,value:e},i(e),9,ce)),64))],8,pe),[[X,p.rows]]),b(y,{modelValue:p.search,"onUpdate:modelValue":o[2]||(o[2]=e=>p.search=e),type:"text",class:"w-3/4 sm:w-auto",placeholder:"Αναζήτηση"},null,8,["modelValue"])]),t("table",be,[t("tbody",fe,[t("tr",ge,[(u(!0),m(f,null,w(l.tableLabels,(e,a)=>(u(),m("td",{key:e,class:g(["p-2 font-semibold",{"text-left sm:text-center":a<3,"sm:hidden xl:table-cell":a==l.tableLabels.length-2,"sm:hidden lg:table-cell":a==l.tableLabels.length-3,"sm:hidden md:table-cell":a==l.tableLabels.length-4}]),title:a>0&&a<9?p.field!==l.fields[a]||p.field==l.fields[a]&&p.direction=="desc"?"αύξουσα ταξινόμηση κατά "+e:"φθίνουσα ταξινόμηση κατά "+e:"",onClick:n=>O(l.fields[a])},[V(t("span",null,"↗",512),[[L,p.field==l.fields[a]&&p.direction=="asc"]]),V(t("span",null,"↘",512),[[L,p.field==l.fields[a]&&p.direction=="desc"]]),U(" "+i(e),1)],10,he))),128))]),(u(!0),m(f,null,w(l.students.data,(e,a)=>(u(),m(f,{key:e.id},[t("tr",ve,[t("td",we,i(a+l.students.from),1),t("td",ye,i(e.id),1),t("td",xe,i(e.sumap==0?" ":e.sumap),1),t("td",_e,i(e.sumapov==0?" ":e.sumapov),1),t("td",ke,i(e.eponimo),1),t("td",Se,i(e.onoma),1),t("td",Ve,i(e.patronimo),1),t("td",Ce,i(e.email),1),t("td",Ae,i(e.tmimataStr),1),t("td",$e,[t("button",{onClick:n=>e.sumap?k.value[e.id]=!k.value[e.id]:!1,class:g(["px-0.5 border rounded bg-green-200 disabled:opacity-30 disabled:bg-gray-100 disabled:cursor-not-allowed",{"cursor-not-allowed":!e.sumap}]),disabled:!e.sumap,title:e.sumap?k.value[e.id]?"Κρύψε απουσίες για "+e.eponimo+" "+e.onoma:"Δείξε απουσίες για "+e.eponimo+" "+e.onoma:""},i(k.value[e.id]&&e.sumap?"➖":"👁"),11,Le),t("button",{onClick:n=>B(e),class:"bg-blue-200 px-0.5 border rounded",title:"Εισαγωγή απουσιών "+e.eponimo+" "+e.onoma}," ➕ ",8,Ue),t("button",{onClick:n=>N(e),class:"bg-yellow-200 px-0.5 border rounded",title:"Επεξεργασία "+e.eponimo+" "+e.onoma}," 🖋 ",8,Ee),t("button",{onClick:n=>T(e),class:"bg-red-200 px-1 border rounded",title:"Διαγραφή "+e.eponimo+" "+e.onoma}," 🗑 ",8,Fe)])]),V(t("tr",De,[t("td",{colspan:l.tableLabels.length,class:"text-center"},[t("table",Be,[t("tbody",je,[t("tr",qe,[(u(!0),m(f,null,w(l.tableApouLabels,(n,v)=>(u(),m("td",{key:n,class:g(["p-1 sm:px-2 font-semibold",{"hidden sm:table-cell":v>3&&v<l.tableApouLabels.length-1}])},i(n),3))),128))]),(u(!0),m(f,null,w(l.apousiesForStudent[e.id],n=>(u(),m(f,{key:n.id},[t("tr",ze,[t("td",Ie,i(n.aa),1),t("td",Me,i(n.aa),1),t("td",Oe,i(n.tot),1),t("td",Te,i(n.dateShow),1),t("td",Re,i(n.sum==0?" ":n.sum),1),t("td",Ze,i(n.sumapov==0?" ":n.sumapov),1),(u(!0),m(f,null,w(n.arrApou.apou,(v,_)=>(u(),m("td",{key:_,class:g(["border-gray-500 border border-l-2 border-r-2 p-1 sm:px-2 text-center hidden sm:table-cell",{"bg-red-100":n.arrApou.apov[_]}]),title:l.arrNames[n.arrApou.teach[_]]},i(v?"+":" "),11,He))),128)),t("td",Pe,[t("button",{onClick:v=>B(e,n),class:"bg-yellow-200 px-0.5 border rounded",title:"Επεξεργασία απουσιών για "+n.dateShow}," 🖋 ",8,We),t("button",{onClick:v=>R(e,n),class:"bg-red-200 px-1 border rounded",title:"Διαγραφή απουσιών για "+n.dateShow}," 🗑 ",8,Ge)])]),t("tr",Je,[t("td",Ke,[t("table",Qe,[t("tr",null,[o[12]||(o[12]=t("td",{class:"w-16 text-right"},"ώρες:",-1)),(u(!0),m(f,null,w(n.arrApou.apou,(v,_)=>(u(),m("td",{key:_,class:g(["w-4",{"opacity-20":!v,"font-medium":v,"bg-red-200":n.arrApou.apov[_]}])},i(_+"η"),3))),128))])])])])],64))),128))])])],8,Ne)],512),[[L,k.value[e.id]&&e.sumap]])],64))),128))])]),b(te,{class:"mx-auto pt-4",links:l.students.links,queryStr:l.queryStr},null,8,["links","queryStr"])])])])])]),_:1}),S.open?(u(),m("div",Xe,[t("div",Ye,[o[21]||(o[21]=t("div",{class:"fixed inset-0 transition-opacity"},[t("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),o[22]||(o[22]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},null,-1)),o[23]||(o[23]=U("​ ")),t("div",et,[t("div",tt,i(A.value?"Επεξεργασία":"Εισαγωγή")+" μαθητή ",1),V(t("div",{class:"text-red-500 mx-4 p-2 text-center"},i(c.msg),513),[[L,c.msg]]),t("div",ot,[o[15]||(o[15]=t("span",{class:"sm:col-start-3"},"Α.Μ.",-1)),b(y,{modelValue:d(s).id,"onUpdate:modelValue":o[3]||(o[3]=e=>d(s).id=e),class:g(["w-full p-1 text-center",{border:!A.value,"select-none":A.value}])},null,8,["modelValue","class"]),o[16]||(o[16]=t("span",{class:"sm:col-span-2"}," ",-1)),o[17]||(o[17]=t("span",null,"Επώνυμο",-1)),b(y,{modelValue:d(s).eponimo,"onUpdate:modelValue":o[4]||(o[4]=e=>d(s).eponimo=e),class:"w-full p-1 col-span-2 border"},null,8,["modelValue"]),o[18]||(o[18]=t("span",null,"Όνομα",-1)),b(y,{modelValue:d(s).onoma,"onUpdate:modelValue":o[5]||(o[5]=e=>d(s).onoma=e),class:"w-full p-1 col-span-2 border"},null,8,["modelValue"]),o[19]||(o[19]=t("span",null,"Πατρώνυμο",-1)),b(y,{modelValue:d(s).patronimo,"onUpdate:modelValue":o[6]||(o[6]=e=>d(s).patronimo=e),class:"w-full p-1 col-span-2 border"},null,8,["modelValue"]),o[20]||(o[20]=t("span",null,"Email",-1)),b(y,{modelValue:d(s).email,"onUpdate:modelValue":o[7]||(o[7]=e=>d(s).email=e),class:"w-full p-1 col-span-2 border"},null,8,["modelValue"]),(u(!0),m(f,null,w(l.tmimataRows,e=>(u(),m(f,{key:e},[o[13]||(o[13]=t("span",null,"Τμήμα",-1)),b(y,{modelValue:d(s).tmima[(e-1)*2],"onUpdate:modelValue":a=>d(s).tmima[(e-1)*2]=a,class:"w-full p-1 col-span-2 border"},null,8,["modelValue","onUpdate:modelValue"]),o[14]||(o[14]=t("span",null,"Τμήμα",-1)),b(y,{modelValue:d(s).tmima[(e-1)*2+1],"onUpdate:modelValue":a=>d(s).tmima[(e-1)*2+1]=a,class:"w-full p-1 col-span-2 border"},null,8,["modelValue","onUpdate:modelValue"])],64))),128))]),t("div",lt,[t("button",{onClick:Z,type:"button",disabled:!d(s).isDirty,class:g(["gthButton disabled:opacity-50",{"cursor-not-allowed":!d(s).isDirty}])}," Αποθήκευση ",10,st),t("button",{onClick:o[8]||(o[8]=e=>S.open=!1),type:"button",class:"gthButton"}," Άκυρο ")])])])])):q("",!0),C.value?(u(),m("div",rt,[t("div",at,[o[24]||(o[24]=t("div",{class:"fixed inset-0 transition-opacity"},[t("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),o[25]||(o[25]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},null,-1)),o[26]||(o[26]=U("​ ")),t("div",nt,[t("div",it,i(x.value?"Επεξεργασία":"Εισαγωγή")+" απουσιών ",1),V(t("div",{class:"text-red-500 mx-4 mt-2 text-center"},i(c.msg),513),[[L,c.msg]]),t("div",dt,i(D.value),1),t("div",mt,[t("div",ut,[b(y,{modelValue:d(r).date,"onUpdate:modelValue":o[9]||(o[9]=e=>d(r).date=e),type:"date",disabled:x.value,class:g(["w-max p-1 text-center",{border:!x.value,"select-none":x.value}])},null,8,["modelValue","disabled","class"])]),t("div",pt,[(u(!0),m(f,null,w(l.totalHours,e=>(u(),m("div",{key:e,class:"text-gray-400 sm:px-1"},[t("div",{class:g(["flex flex-col",{"bg-red-200":d(r).apov[e]}]),title:l.arrNames[d(r).teach[e]]},[t("span",null,i(e)+"η",1),b(le,{class:"ml-0.5 bg-white",modelValue:d(r).apou[e],"onUpdate:modelValue":a=>d(r).apou[e]=a,checked:d(r).apou[e],onClick:a=>G(e)},null,8,["modelValue","onUpdate:modelValue","checked","onClick"]),t("div",{class:g(["h-2 bg-gray-300 mt-1 cursor-pointer rounded",{"bg-red-400":d(r).apov[e]}]),title:"Αποβολή",onClick:a=>W(e)},null,10,bt)],10,ct)]))),128))])]),t("div",ft,[t("button",{onClick:H,type:"button",disabled:!d(r).isDirty,class:g(["gthButton disabled:opacity-50",{"cursor-not-allowed":!d(r).isDirty}])}," Αποθήκευση ",10,gt),t("button",{onClick:o[10]||(o[10]=e=>C.value=!1),type:"button",class:"gthButton"}," Άκυρο ")])])])])):q("",!0)],64))}}),$t=se(ht,[["__scopeId","data-v-8afe6c48"]]);export{$t as default};
