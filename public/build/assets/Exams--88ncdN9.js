import{d as Q,r as O,j as D,C as R,c as l,o as d,a as w,h as N,u as a,m as Y,w as $,b as s,e as E,t as n,f as b,v as y,P as j,q as u,F as h,l as S,s as T,x as V,W as I,n as p,y as F}from"./app-B-cmbjvL.js";import{_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-PEPtDQ3f.js";import{_ as ee}from"./Input.vue_vue_type_script_setup_true_lang-CyUlp5Kt.js";import{_ as te}from"./GthSuccess.vue_vue_type_script_setup_true_lang-kvLgG3Gb.js";import{_ as se}from"./GthError.vue_vue_type_script_setup_true_lang-BLuSXH5t.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CzG4im2e.js";import"./RovingFocusGroup-2U8FBijs.js";import"./useForwardExpose-CZ06Ebnk.js";const re={class:"px-4 pt-4 w-full max-w-7xl mx-auto"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ne={class:"p-6 bg-white border-b border-gray-200 flex justify-between"},ie={class:"w-max self-center space-x-1 sm:space-x-2"},le=["href"],de={class:"max-w-7xl mx-auto px-4"},ue={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},pe={id:"calendar",class:"p-4 bg-white border-b border-gray-200"},me={class:"font-bold text-xl pb-4 flex space-x-2 space-y-2 flex-col md:flex-row md:space-y-0 items-center justify-center"},ge={class:"flex space-x-2"},be=["title"],fe=["onClick","onDrop"],ve={class:"flex max-w-min"},ce=["title","onClick","draggable","onDragstart"],xe={class:"font-bold text-xl flex space-x-2 space-y-2 flex-col md:flex-row md:space-y-0 items-center justify-center"},ye={class:"flex space-x-2"},he=["title"],we={key:0,class:"fixed z-10 inset-0 overflow-y-auto ease-out duration-400"},Se={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ke={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},De={class:"font-semibold text-xl p-2 bg-gray-100 rounded-t-md mx-4 mt-4"},Ee={class:"grid grid-cols-3 sm:grid-cols-6 gap-4 bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ie=["value","disabled"],Ce=["value"],$e=["value","disabled"],Te=["value"],Oe=["value","disabled"],Ve=["value"],Be={class:"bg-gray-100 px-4 py-3 sm:px-6 text-right space-x-2"},Le=["disabled"],_e={key:1,class:"fixed z-10 inset-0 overflow-y-auto ease-out duration-400"},Me={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ne={class:"text-gray-900 p-4",v:""},je={class:"font-bold col-span-1 md:col-span-3"},Fe={class:"bg-gray-100 px-4 py-3 sm:px-6 text-right space-x-2"},Ue=Q({__name:"Exams",props:{mathimata:{},month:{},year:{},dateValues:{},selectedMonth:{},exams:{},formExams:{},noExams:{},initGridmode:{}},setup(U){const v=U,i=O(v.initGridmode),k=O(""),c=D({open:!1}),C=D({open:!1}),B=D({data:[]}),x=O(!1),f=D({tmima1:[],tmima2:[]}),r=R(v.formExams),m=D({msg:""});function L(){let t=v.month-1,e=v.year;t<1&&(t=12,e=e-1),I.get(route("exams",{y:e,m:t,g:i.value}),{},{preserveScroll:!0})}function _(){let t=v.month+1,e=v.year;t>12&&(t=1,e=e+1),I.get(route("exams",{y:e,m:t,g:i.value}),{},{preserveScroll:!0})}function z(t){if(!p().props.auth.user.permissions.admin&&v.noExams[t])return;k.value=t,F.get("exams/tmimata/"+t).then(function(o){f.tmima1=o.data}),x.value=!1,r.reset(),r.date=t,m.msg="",c.open=!0;const e=o=>{o.keyCode===27&&(c.open=!1,document.removeEventListener("keydown",e))};document.addEventListener("keydown",e)}function J(t){f.tmima2=[],t.target.value?Object.keys(f.tmima1).forEach(e=>{f.tmima1[e]!==t.target.value&&f.tmima1[e]!=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑΤΑ"&&f.tmima2.push(f.tmima1[e])}):r.tmima2=""}function P(t){if(k.value=t.date,!p().props.auth.user.permissions.admin&&parseInt(t.user_id)!==parseInt(p().props.auth.user.id))return;f.tmima1=[t.tmima1],f.tmima2=[t.tmima2],x.value=!0,r.reset(),r.id=t.id,r.user_id=t.user_id,r.date=t.date,r.title=t.title,r.tmima1=t.tmima1,r.tmima2=t.tmima2,r.mathima=t.mathima,m.msg="",c.open=!0;const e=o=>{o.keyCode===27&&(c.open=!1,document.removeEventListener("keydown",e))};document.addEventListener("keydown",e)}function A(t,e){k.value=e.date,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("exam",JSON.stringify(e))}function G(t,e){if(e==k||!p().props.auth.user.permissions.admin&&p().props.auth.user.id!=JSON.parse(t.dataTransfer.getData("exam")).user_id)return;if(!p().props.auth.user.permissions.admin&&v.noExams[e]){m.msg="Όχι διαγωνίσματα τις "+new Date(e).toLocaleDateString();return}const o=JSON.parse(t.dataTransfer.getData("exam"));I.put(route("exams.update",{event:o.id,date:e}),{},{preserveScroll:!0})}function W(t){if(i){if(t.tmima1=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑΤΑ"||t.mathima=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑ")return"text-white bg-red-500 hover:bg-red-700";if(t.date.replace(/-/g,"")<new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id==p().props.auth.user.id)return"text-white bg-blue-500 hover:bg-blue-700 opacity-40";if(t.date.replace(/-/g,"")<new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id!==p().props.auth.user.id)return"text-white bg-gray-500 hover:bg-gray-700 opacity-40";if(t.date.replace(/-/g,"")>=new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id==p().props.auth.user.id)return"text-white bg-blue-500 hover:bg-blue-700";if(t.date.replace(/-/g,"")>=new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id!==p().props.auth.user.id)return"text-white bg-gray-500 hover:bg-gray-700"}else{if(t.tmima1=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑΤΑ"||t.mathima=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑ")return"text-white bg-red-500 hover:bg-red-700 md:ml-24 ";if(t.date.replace(/-/g,"")<new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id==p().props.auth.user.id)return"opacity-40 font-semibold text-blue-700 hover:text-blue-900 bg-transparent hover:bg-yellow-100 md:ml-24 border-0";if(t.date.replace(/-/g,"")<new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id!==p().props.auth.user.id)return"opacity-40 font-semibold text-gray-700 hover:text-gray-900 bg-transparent hover:bg-yellow-100 md:ml-24 border-0";if(t.date.replace(/-/g,"")>=new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id==p().props.auth.user.id)return"font-semibold text-blue-700 hover:text-blue-900 bg-transparent hover:bg-yellow-100  md:ml-24 border-0";if(t.date.replace(/-/g,"")>=new Date().toISOString().split("T")[0].replace(/-/g,"")&&t.user_id!==p().props.auth.user.id)return"font-semibold text-gray-700 hover:text-gray-900 bg-transparent hover:bg-yellow-100 md:ml-24 border-0"}}function q(){if(!r.date){m.msg="Επιλέξτε ημερομηνία.";return}if(!r.tmima1){m.msg="Επιλέξτε ένα τμήμα.";return}if(!r.mathima&&r.tmima1!=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑΤΑ"){m.msg="Επιλέξτε ένα μάθημα.";return}let t=!0;if(p().props.auth.user.permissions.admin||v.exams.hasOwnProperty(r.date)&&v.exams[r.date].forEach(e=>{e.tmima1=="ΟΧΙ_ΔΙΑΓΩΝΙΣΜΑΤΑ"&&(t=!1)}),!t){m.msg="Όχι διαγωνίσματα τις "+new Date(r.date).toLocaleDateString();return}if(!r.id)r.post(route("exams.store"),{preserveScroll:!0}),m.msg="",c.open=!1,r.reset();else{if(r.date==k){m.msg="",c.open=!1,r.reset();return}I.put(route("exams.update",{event:r.id,date:r.date}),{},{preserveScroll:!0}),c.open=!1,r.reset()}}function K(){I.delete(route("deleteExam",{id:r.id}),{onBefore:()=>confirm(`Διαγραφή διαγωνίσματος

Ημνια: `+new Date(r.date).toLocaleDateString()+`
`+r.title+`

Να διαγραφεί;`),preserveScroll:!0}),c.open=!1}function X(){F.get("userExams").then(function(t){B.data=t.data,C.open=!0;const e=o=>{o.keyCode===27&&(C.open=!1,document.removeEventListener("keydown",e))};document.addEventListener("keydown",e)})}function H(){return new Date().toLocaleTimeString()}return(t,e)=>(d(),l(h,null,[w(a(Y),{title:"Διαγωνίσματα"}),w(Z,null,{default:$(()=>[w(te,{property:"success"},{default:$(()=>[E(n(H()),1)]),_:1}),w(se,{property:"error"}),s("div",re,[s("div",ae,[s("div",ne,[e[17]||(e[17]=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Διαγωνίσματα ",-1)),s("div",ie,[b(s("a",{class:"gthButton",href:t.route("exportExamsXls",{year:t.year,month:t.month})}," Εξαγωγή ",8,le),[[y,t.$page.props.auth.user.permissions.admin]]),s("button",{class:"gthButton",onClick:X}," Τα διαγωνίσματά μου ")])])])]),s("div",null,[s("div",de,[s("div",ue,[s("div",pe,[s("div",me,[s("span",null,n(t.selectedMonth),1),s("div",ge,[s("button",{onClick:e[0]||(e[0]=o=>L()),class:"px-2 border rounded font-extrabold text-2xl",title:"προηγούμενος μήνας"}," < "),b(w(a(j),{href:t.route("exams",{g:i.value.value},{preserveScroll:!0}),class:"px-1 border rounded font-extrabold text-2xl",title:"σήμερα","preserve-state":"","preserve-scroll":""},{default:$(()=>e[18]||(e[18]=[E("⛪")])),_:1},8,["href"]),[[y,t.month!==parseInt(new Date().toISOString().split("T")[0].substr(5,2))]]),s("button",{class:"px-2 border rounded font-extrabold text-2xl",onClick:e[1]||(e[1]=o=>i.value=!i.value),title:i.value?"Λίστα":"Πλέγμα"},n(i.value?"▤":"▦"),9,be),s("button",{onClick:e[2]||(e[2]=o=>_()),class:"px-2 border rounded font-extrabold text-2xl",title:"επόμενος μήνας"}," > ")])]),s("div",{class:u(["grid grid-cols-1 gap-0.5 bg-white :p-6 sm:pb-4",{"md:grid-cols-5":i.value}])},[(d(),l(h,null,S(["Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή"],o=>s("div",{key:o,class:u(["font-semibold text-gray-700 hidden border rounded px-2",{"md:table-cell":i.value}])},n(o),3)),64)),(d(!0),l(h,null,S(t.dateValues,o=>(d(),l("div",{key:o.date,class:u(["min-h-20 border border-gray-300 bg-white hover:border-blue-500 rounded",{"md:min-h-12":!i.value,hidden:parseInt(o.date.substr(5,2))!==t.month,"md:table-cell":parseInt(o.date.substr(5,2))!==t.month&&i.value,"bg-blue-100 hover:bg-blue-200":o.date==new Date().toISOString().split("T")[0],"bg-gray-50 hover:bg-gray-100":parseInt(o.date.substr(5,2))!==t.month,"hover:bg-yellow-50 ":parseInt(o.date.substr(5,2))==t.month,"bg-red-200 hover:bg-red-300":t.noExams[o.date]}]),onClick:T(g=>z(o.date),["self"]),onDrop:g=>G(g,o.date),onDragover:e[3]||(e[3]=T(()=>{},["prevent"])),onDragenter:e[4]||(e[4]=T(()=>{},["prevent"]))},[s("div",ve,[s("div",{class:u(["font-bold ml-1 pl-1 pr-2 w-10",{"opacity-50":parseInt(o.date.substr(5,2))!==t.month,"md:hidden":i.value}])},n(o.shortName),3),s("div",{class:u(["font-bold",{"opacity-50":parseInt(o.date.substr(5,2))!==t.month}])},n(o.date.substr(-2)+"/"+o.date.substr(5,2)),3)]),(d(!0),l(h,null,S(t.exams[o.date],g=>(d(),l("div",{key:g.id,class:u(["border border-gray-300 rounded mx-1 px-2 truncate",W(g)]),title:g.title,onClick:M=>P(g),draggable:g.user_id==t.$page.props.auth.user.id||t.$page.props.auth.user.permissions.admin,onDragstart:M=>A(M,g)},n(g.title),43,ce))),128))],42,fe))),128))],2),s("div",xe,[s("span",null,n(t.selectedMonth),1),s("div",ye,[s("button",{onClick:e[5]||(e[5]=o=>L()),class:"px-2 border rounded font-extrabold text-2xl",title:"προηγούμενος μήνας"}," < "),b(w(a(j),{href:t.route("exams",{g:i.value.value},{preserveScroll:!0}),class:"px-1 border rounded font-extrabold text-2xl",title:"σήμερα","preserve-state":"","preserve-scroll":""},{default:$(()=>e[19]||(e[19]=[E("⛪")])),_:1},8,["href"]),[[y,t.month!==parseInt(new Date().toISOString().split("T")[0].substr(5,2))]]),s("button",{class:"px-2 border rounded font-extrabold text-2xl",onClick:e[6]||(e[6]=o=>i.value=!i.value),title:i.value?"Λίστα":"Πλέγμα"},n(i.value?"▤":"▦"),9,he),s("button",{onClick:e[7]||(e[7]=o=>_()),class:"px-2 border rounded font-extrabold text-2xl",title:"επόμενος μήνας"}," > ")])])])])])])]),_:1}),c.open?(d(),l("div",we,[s("div",Se,[e[28]||(e[28]=s("div",{class:"fixed inset-0 transition-opacity"},[s("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),e[29]||(e[29]=s("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},null,-1)),e[30]||(e[30]=E("​ ")),s("div",ke,[s("div",De,n(x.value?"Επεξεργασία":"Δήλωση")+" διαγωνίσματος ",1),b(s("div",{class:"text-red-500 mx-4 p-2 text-center"},n(m.msg),513),[[y,m.msg]]),b(s("div",{class:"text-gray-900 mx-4 p-2 text-center font-semibold text-xl"},n(a(r).title),513),[[y,a(r).title]]),s("div",Ee,[e[23]||(e[23]=s("span",{class:"sm:col-start-3 items-center"},"Ημνια",-1)),w(ee,{type:"date",modelValue:a(r).date,"onUpdate:modelValue":e[8]||(e[8]=o=>a(r).date=o),disabled:!x.value,onKeydown:e[9]||(e[9]=T(()=>{},["prevent"])),onClick:e[10]||(e[10]=o=>m.msg=""),class:u(["w-full p-1 text-center col-span-2 disabled:opacity-50",{border:x.value,"select-none":!x.value}])},null,8,["modelValue","disabled","class"]),e[24]||(e[24]=s("span",{class:"hidden sm:table-cell"}," ",-1)),e[25]||(e[25]=s("span",null,"Τμήμα",-1)),b(s("select",{"onUpdate:modelValue":e[11]||(e[11]=o=>a(r).tmima1=o),value:a(r).tmima1,disabled:x.value,onChange:e[12]||(e[12]=o=>J(o)),class:"border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-100 rounded-md shadow-sm sm:px-2 w-full p-1 col-span-2 border disabled:opacity-50"},[e[20]||(e[20]=s("option",{value:""},null,-1)),(d(!0),l(h,null,S(f.tmima1,o=>(d(),l("option",{key:o,value:o},n(o),9,Ce))),128))],40,Ie),[[V,a(r).tmima1]]),e[26]||(e[26]=s("span",null,"Τμήμα",-1)),b(s("select",{"onUpdate:modelValue":e[13]||(e[13]=o=>a(r).tmima2=o),value:a(r).tmima2,disabled:!a(r).tmima1||x.value,class:"border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-100 rounded-md shadow-sm sm:px-2 w-full p-1 col-span-2 border disabled:opacity-50"},[e[21]||(e[21]=s("option",{value:""},null,-1)),(d(!0),l(h,null,S(f.tmima2,o=>(d(),l("option",{key:o,value:o},n(o),9,Te))),128))],8,$e),[[V,a(r).tmima2]]),e[27]||(e[27]=s("span",null,"Μάθημα",-1)),b(s("select",{"onUpdate:modelValue":e[14]||(e[14]=o=>a(r).mathima=o),value:a(r).mathima,disabled:x.value,class:"border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-100 rounded-md shadow-sm sm:px-2 w-full p-1 col-span-2 sm:col-span-5 border disabled:opacity-50"},[e[22]||(e[22]=s("option",{value:""},null,-1)),(d(!0),l(h,null,S(t.mathimata,o=>(d(),l("option",{key:o,value:o},n(o),9,Ve))),128))],8,Oe),[[V,a(r).mathima]])]),s("div",Be,[b(s("button",{onClick:K,type:"button",class:"gthButton disabled:opacity-50"}," Διαγραφή ",512),[[y,x.value&&(a(r).user_id==t.$page.props.auth.user.id||t.$page.props.auth.user.permissions.admin)]]),b(s("button",{onClick:q,type:"button",disabled:!a(r).isDirty,class:u(["gthButton disabled:opacity-50",{"cursor-not-allowed":!a(r).isDirty}])}," Αποθήκευση ",10,Le),[[y,!a(r).user_id||a(r).user_id==t.$page.props.auth.user.id||t.$page.props.auth.user.permissions.admin]]),s("button",{onClick:e[15]||(e[15]=o=>c.open=!1),type:"button",class:"gthButton"}," Άκυρο ")])])])])):N("",!0),C.open?(d(),l("div",_e,[s("div",Me,[e[36]||(e[36]=s("div",{class:"fixed inset-0 transition-opacity"},[s("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),e[37]||(e[37]=s("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},null,-1)),e[38]||(e[38]=E("​ ")),s("div",{class:u(["inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all md:my-8 md:align-middle md:max-w-2xl md:w-full",{"lg:max-w-4xl":t.$page.props.auth.user.permissions.admin}]),role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},[e[35]||(e[35]=s("div",{class:"font-semibold text-xl bg-gray-100 rounded-t-md mx-4 mt-4 p-4"}," Τα διαγωνίσματά μου ",-1)),s("div",Ne,[s("div",{class:u(["grid grid-cols-1 gap-1",{"md:grid-cols-9":!t.$page.props.auth.user.permissions.admin,"md:grid-cols-12":t.$page.props.auth.user.permissions.admin}])},[e[31]||(e[31]=s("div",{class:"md:text-center font-bold"},"Α/Α",-1)),e[32]||(e[32]=s("div",{class:"md:text-center font-bold col-span-1 md:col-span-2"}," Ημ/νια ",-1)),e[33]||(e[33]=s("div",{class:"md:text-center font-bold col-span-1 md:col-span-2"}," Τμήμα ",-1)),e[34]||(e[34]=s("div",{class:"font-bold col-span-1 md:col-span-4"},"Μάθημα",-1)),b(s("div",je," Καθηγητής ",512),[[y,t.$page.props.auth.user.permissions.admin]]),(d(!0),l(h,null,S(B.data,(o,g)=>(d(),l(h,{key:g},[s("div",{class:u(["md:text-center",{"opacity-50":o.date<new Date().toISOString().split("T")[0].replace(/-/g,"")}])},n(o.aa),3),s("div",{class:u(["md:text-center col-span-1 md:col-span-2",{"opacity-50":o.date<new Date().toISOString().split("T")[0].replace(/-/g,"")}])},n(o.dateShow),3),s("div",{class:u(["md:text-center col-span-1 md:col-span-2 truncate",{"opacity-50":o.date<new Date().toISOString().split("T")[0].replace(/-/g,"")}])},n(o.tmima),3),s("div",{class:u(["col-span-1 md:col-span-4 truncate",{"opacity-50":o.date<new Date().toISOString().split("T")[0].replace(/-/g,"")}])},n(o.mathima),3),b(s("div",{class:u(["col-span-1 md:col-span-3 truncate",{"opacity-50":o.date<new Date().toISOString().split("T")[0].replace(/-/g,"")}])},n(o.teacher),3),[[y,t.$page.props.auth.user.permissions.admin]])],64))),128))],2)]),s("div",Fe,[s("button",{onClick:e[16]||(e[16]=o=>C.open=!1),type:"button",class:"gthButton"}," Εντάξει ")])],2)])])):N("",!0)],64))}}),He=oe(Ue,[["__scopeId","data-v-023aab23"]]);export{He as default};
